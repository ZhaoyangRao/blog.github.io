<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>cookie | RaoCy</title>
    <meta name="description" content="欢迎来到RaoCy博客">
    <link rel="icon" href="/blog.github.io/images/logo.png">
    
    <link rel="preload" href="/blog.github.io/assets/css/0.styles.59e117d8.css" as="style"><link rel="preload" href="/blog.github.io/assets/js/app.fa2756ba.js" as="script"><link rel="preload" href="/blog.github.io/assets/js/2.08fb6a77.js" as="script"><link rel="preload" href="/blog.github.io/assets/js/4.0c40ed64.js" as="script"><link rel="prefetch" href="/blog.github.io/assets/js/10.f22ebfd2.js"><link rel="prefetch" href="/blog.github.io/assets/js/11.c234647a.js"><link rel="prefetch" href="/blog.github.io/assets/js/12.11cd38ed.js"><link rel="prefetch" href="/blog.github.io/assets/js/13.beee3256.js"><link rel="prefetch" href="/blog.github.io/assets/js/14.612e31b7.js"><link rel="prefetch" href="/blog.github.io/assets/js/15.00511f46.js"><link rel="prefetch" href="/blog.github.io/assets/js/16.84bcf99b.js"><link rel="prefetch" href="/blog.github.io/assets/js/17.1a599d19.js"><link rel="prefetch" href="/blog.github.io/assets/js/18.30e47f41.js"><link rel="prefetch" href="/blog.github.io/assets/js/19.6cba97f6.js"><link rel="prefetch" href="/blog.github.io/assets/js/20.06c10bc7.js"><link rel="prefetch" href="/blog.github.io/assets/js/21.b2e76090.js"><link rel="prefetch" href="/blog.github.io/assets/js/22.c8f5b237.js"><link rel="prefetch" href="/blog.github.io/assets/js/23.2891f3cb.js"><link rel="prefetch" href="/blog.github.io/assets/js/24.eda369d5.js"><link rel="prefetch" href="/blog.github.io/assets/js/25.8e109bb7.js"><link rel="prefetch" href="/blog.github.io/assets/js/26.9b670c4a.js"><link rel="prefetch" href="/blog.github.io/assets/js/27.518dbe12.js"><link rel="prefetch" href="/blog.github.io/assets/js/28.3f289a1b.js"><link rel="prefetch" href="/blog.github.io/assets/js/29.e5d2970d.js"><link rel="prefetch" href="/blog.github.io/assets/js/3.e1227595.js"><link rel="prefetch" href="/blog.github.io/assets/js/30.c96b9d16.js"><link rel="prefetch" href="/blog.github.io/assets/js/31.c61fff3d.js"><link rel="prefetch" href="/blog.github.io/assets/js/32.457903f2.js"><link rel="prefetch" href="/blog.github.io/assets/js/33.bbbe8e6b.js"><link rel="prefetch" href="/blog.github.io/assets/js/34.a18faace.js"><link rel="prefetch" href="/blog.github.io/assets/js/35.35bb20f9.js"><link rel="prefetch" href="/blog.github.io/assets/js/36.87178d4a.js"><link rel="prefetch" href="/blog.github.io/assets/js/37.19b3528a.js"><link rel="prefetch" href="/blog.github.io/assets/js/38.1fb79f44.js"><link rel="prefetch" href="/blog.github.io/assets/js/39.7b4c5fc7.js"><link rel="prefetch" href="/blog.github.io/assets/js/40.541ac0d4.js"><link rel="prefetch" href="/blog.github.io/assets/js/41.aac81066.js"><link rel="prefetch" href="/blog.github.io/assets/js/5.24bd3210.js"><link rel="prefetch" href="/blog.github.io/assets/js/6.6b979b3c.js"><link rel="prefetch" href="/blog.github.io/assets/js/7.a1080829.js"><link rel="prefetch" href="/blog.github.io/assets/js/8.3f1e94ff.js"><link rel="prefetch" href="/blog.github.io/assets/js/9.fcceb79b.js">
    <link rel="stylesheet" href="/blog.github.io/assets/css/0.styles.59e117d8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog.github.io/" class="home-link router-link-active"><!----> <span class="site-name">RaoCy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端构建工具" class="dropdown-title"><span class="title">前端构建工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/study/webpack/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/gulp/" class="nav-link">gulp</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器的世界" class="dropdown-title"><span class="title">浏览器的世界</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserKey/" class="nav-link">浏览器内核</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browser/" class="nav-link">浏览器多线程多进程</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserOpen/" class="nav-link">浏览器同域名请求并发限制</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserDns/" class="nav-link">浏览器DNS域名解析</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/broeweSafe/" class="nav-link">浏览器的安全</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserCache/" class="nav-link">浏览器的缓存</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/webworker/" class="nav-link">Web Worker</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/iframe/" class="nav-link">iframe</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/http/" class="nav-link">http协议</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/cookie/" class="nav-link">cookie</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端知识点" class="dropdown-title"><span class="title">前端知识点</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/modules/" class="nav-link">前端开发模式</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/jsnull/" class="nav-link">null与undefined</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/eventLoop/" class="nav-link">宏任务和微任务</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/callback/" class="nav-link">js异步编程方案</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/iterable/" class="nav-link">iterator迭代器</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/closure/" class="nav-link">闭包</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/funcHigh/" class="nav-link">高阶函数</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/this/" class="nav-link">js中的this</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/class/" class="nav-link">js中的面向对象</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/event/" class="nav-link">js里的事件模型</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/diff/" class="nav-link">diff算法</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/module/" class="nav-link">前端模块化规范</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端技术杂玩" class="dropdown-title"><span class="title">前端技术杂玩</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/react/index/" class="nav-link">react</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/mongodb/api/" class="nav-link">mongodb</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/vuecli/index/" class="nav-link">vuecli</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/mxgraph/index/" class="nav-link">mxgraph</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/prerender-spa-plugin/index/" class="nav-link">prerender-spa-plugin</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端构建工具" class="dropdown-title"><span class="title">前端构建工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/study/webpack/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/gulp/" class="nav-link">gulp</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="浏览器的世界" class="dropdown-title"><span class="title">浏览器的世界</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserKey/" class="nav-link">浏览器内核</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browser/" class="nav-link">浏览器多线程多进程</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserOpen/" class="nav-link">浏览器同域名请求并发限制</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserDns/" class="nav-link">浏览器DNS域名解析</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/broeweSafe/" class="nav-link">浏览器的安全</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/browserCache/" class="nav-link">浏览器的缓存</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/webworker/" class="nav-link">Web Worker</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/iframe/" class="nav-link">iframe</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/http/" class="nav-link">http协议</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/cookie/" class="nav-link">cookie</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端知识点" class="dropdown-title"><span class="title">前端知识点</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/modules/" class="nav-link">前端开发模式</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/jsnull/" class="nav-link">null与undefined</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/eventLoop/" class="nav-link">宏任务和微任务</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/callback/" class="nav-link">js异步编程方案</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/iterable/" class="nav-link">iterator迭代器</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/closure/" class="nav-link">闭包</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/funcHigh/" class="nav-link">高阶函数</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/this/" class="nav-link">js中的this</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/class/" class="nav-link">js中的面向对象</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/event/" class="nav-link">js里的事件模型</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/diff/" class="nav-link">diff算法</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/study/module/" class="nav-link">前端模块化规范</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端技术杂玩" class="dropdown-title"><span class="title">前端技术杂玩</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog.github.io/react/index/" class="nav-link">react</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/mongodb/api/" class="nav-link">mongodb</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/vuecli/index/" class="nav-link">vuecli</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/mxgraph/index/" class="nav-link">mxgraph</a></li><li class="dropdown-item"><!----> <a href="/blog.github.io/prerender-spa-plugin/index/" class="nav-link">prerender-spa-plugin</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>cookie</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog.github.io/study/cookie.html#cookie" class="sidebar-link">cookie</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog.github.io/study/cookie.html#cookie机制" class="sidebar-link">cookie机制</a></li><li class="sidebar-sub-header"><a href="/blog.github.io/study/cookie.html#cookie主要属性" class="sidebar-link">cookie主要属性</a></li><li class="sidebar-sub-header"><a href="/blog.github.io/study/cookie.html#cookie的缺点" class="sidebar-link">cookie的缺点</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h2> <p>为什么会出现cookie？<br>
主要是现在主流的http协议，是无状态的协议，无状态的意思就是无法记录状态，对于http请求来说每一次都是独立的，各个请求之间没有直接联系。<br>
这样会产生一个问题，日常的前端开发涉及到用户，要怎么去记录每次请求都跟这个用户有联系呢，所以就需要请求每次都携带一个用户的标识，就诞生了cookie。(也不只是cookie，比如session等)</p> <h3 id="cookie机制"><a href="#cookie机制" class="header-anchor">#</a> cookie机制</h3> <ul><li>客户端发起一条请求到服务器</li> <li>服务器响应，响应里面就包括set-cookie的头部信息</li> <li>客户端保存下来，之后发起请求就携带cookie的头部信息</li></ul> <p><img src="/blog.github.io/assets/img/cookie.c1a9c60c.png" alt="avatar"></p> <h3 id="cookie主要属性"><a href="#cookie主要属性" class="header-anchor">#</a> cookie主要属性</h3> <p><img src="/blog.github.io/assets/img/cookie2.253eb5b3.png" alt="avatar"></p> <p>随便从谷歌浏览器一个网站截图cookie的列表，每一条cookie都有Name,Value,Domain,Path,Expires/Max-Age,Size,HttpOnly,Secure,samesite,Priority等等属性</p> <h4 id="domain"><a href="#domain" class="header-anchor">#</a> Domain</h4> <p>生成该 Cookie 的域名，如 domain=&quot;www.baidu.com&quot;
cookie是不可以跨域名的，诞生可以通过设置domain来间接实现多域名共享cookie，例如设置domain='.baidu.com'，那么'a.baidu.com','b.baidu.com'都可以访问到这个cookie</p> <h4 id="path"><a href="#path" class="header-anchor">#</a> Path</h4> <p>该 Cookie 是在当前的哪个路径下生成的，如 path=/wp-admin/。<br>
path属性决定允许访问Cookie的路径，比如，设置为&quot;/&quot;表示允许所有路径都可以使用Cookie。</p> <h4 id="expires-max-age"><a href="#expires-max-age" class="header-anchor">#</a> Expires/Max-Age</h4> <p>这个属性主要是用来设置Cookie的有效期，Max-Age的值，其实你可以看到Expires显示的是 '2022-01-21T02:35:53.288Z'或者Session</p> <p>其实通通跟设置的max-age有关系<br>
通过getMaxAge()和setMaxAge(int maxAge)来读写该属性。maxAge有3种值，分别为正数，负数和0。max-age单位为秒</p> <p>max-age默认就是-1<br>
cookie默认是Session的，即cookie默认是浏览器会话期间存在，关闭浏览器就会被清除，此时max-age默认就是-1，如果想让cookie存在一段时间，就需要设置Max-Age为正数了，就会显示具体的失效时间了。</p> <p>Max-Age为正数<br>
这里的这个时间也很好理解，无非就是当前的服务器时间跟它对比，到期就无效了呗（其实这个时间也是通过Max-Age计算出来的结果）</p> <p>max-age为0<br>
当设置max-age为0的时候就表示清除cookie</p> <h4 id="httponly"><a href="#httponly" class="header-anchor">#</a> HttpOnly</h4> <p>这个属性诞生主要还是因为安全，设置httpOnly主要是可以限制js等脚本去获取cookie，忽略那些通过&quot;非 HTTP&quot; 方式对 cookie 的访问。这个属性对于XSS,CSRF攻击其实都有很好的作用</p> <h4 id="secure"><a href="#secure" class="header-anchor">#</a> secure</h4> <p>同样的，这个属性也是因为安全诞生的，主要的功能是设置secure，就只会在https得请求中才会携带cookie</p> <h4 id="samesite"><a href="#samesite" class="header-anchor">#</a> samesite</h4> <p>samesite这个属性我在web安全得时候也提到过，对于CSRF攻击很有用，主要的作用就是限制cookie发送的条件，但是存在兼容性问题
通常情况下设置samesite的strict和lax已经能杜绝大部分CSRF了</p> <p>strict完全禁止第三方 Cookie，跨站点时，任何情况下都不会发送 Cookie</p> <p>Lax属于部分禁止</p> <table><thead><tr><th>请求类型</th> <th style="text-align:center;">示例</th> <th style="text-align:right;">正常情况</th> <th style="text-align:right;">Lax</th></tr></thead> <tbody><tr><td>链接</td> <td style="text-align:center;">&lt;a href=&quot;...&quot;&gt;&lt;/a&gt;</td> <td style="text-align:right;">发送 Cookie</td> <td style="text-align:right;">发送 Cookie</td></tr> <tr><td>预加载</td> <td style="text-align:center;">&lt;link rel=&quot;prerender&quot; href=&quot;...&quot;/&gt;</td> <td style="text-align:right;">发送 Cookie</td> <td style="text-align:right;">发送 Cookie</td></tr> <tr><td>GET 表单</td> <td style="text-align:center;">&lt;form method=&quot;GET&quot; action=&quot;...&quot;&gt;</td> <td style="text-align:right;">发送 Cookie</td> <td style="text-align:right;">发送 Cookie</td></tr> <tr><td>POST 表单</td> <td style="text-align:center;">&lt;form method=&quot;POST&quot; action=&quot;...&quot;&gt;</td> <td style="text-align:right;">发送 Cookie</td> <td style="text-align:right;">不发送</td></tr> <tr><td>iframe</td> <td style="text-align:center;">&lt;iframe src=&quot;...&quot;&gt;&lt;/iframe&gt;</td> <td style="text-align:right;">发送 Cookie</td> <td style="text-align:right;">不发送</td></tr> <tr><td>AJAX</td> <td style="text-align:center;">$.get(&quot;...&quot;)</td> <td style="text-align:right;">发送 Cookie</td> <td style="text-align:right;">不发送</td></tr> <tr><td>Image</td> <td style="text-align:center;">&lt;img src=&quot;...&quot;&gt;</td> <td style="text-align:right;">发送 Cookie</td> <td style="text-align:right;">不发送</td></tr></tbody></table> <p>None关闭该属性，HTTP 接口不支持 SameSite=none，如果你想加 SameSite=none 属性，那么该 Cookie 就必须同时加上 Secure 属性，表示只有在 HTTPS 协议下该 Cookie 才会被发送。(部分浏览器也存在兼容性问题)</p> <h3 id="cookie的缺点"><a href="#cookie的缺点" class="header-anchor">#</a> cookie的缺点</h3> <ul><li>cookie的数量喝大小都有限制，通常情况下大小为4KB，数量大约50个</li> <li>cookie的安全问题，存储再浏览器端，可以被篡改等</li> <li>每条请求携带cookie，增加请求大小</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog.github.io/assets/js/app.fa2756ba.js" defer></script><script src="/blog.github.io/assets/js/2.08fb6a77.js" defer></script><script src="/blog.github.io/assets/js/4.0c40ed64.js" defer></script>
  </body>
</html>
